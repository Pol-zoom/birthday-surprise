<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Хакерская открытка для Алёны</title>
<style>
  :root{
    --bg:#1a0a2a;
    --neon:#ff00ff;
    --neon-2:#8a2be2;
    --neon-cyan:#00ffff;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    min-height:100vh;
    background:var(--bg);
    font-family: "Courier New", monospace;
    color:var(--neon);
    display:flex;
    justify-content:center;
    align-items:center;
    overflow:hidden;
  }

  /* колоночка кода справа */
  .code-background{
    position:fixed;
    top:0;
    right:0;
    width:36%;            /* регулируй ширину правой колонки */
    height:100%;
    padding:24px 18px;
    pointer-events:none;
    display:flex;
    flex-direction:column;
    gap:2px;
    align-items:flex-end; /* текст прижат вправо */
    overflow:hidden;
    opacity:0.12;
  }
  .code-line{
    width:100%;
    text-align:right;
    white-space:nowrap;   /* строки не ломаются посередине */
    font-size:12px;
    line-height:1.1;
    letter-spacing:0.6px;
    color:inherit;
  }

  /* экран со сценой в центре */
  .screen{
    position:relative;
    z-index:2;
    width:58%;
    max-width:760px;
    min-width:320px;
    padding:28px;
    background:rgba(10,3,20,0.88);
    border-radius:16px;
    border:2px solid var(--neon);
    box-shadow:0 0 18px var(--neon),0 0 36px var(--neon-2),0 0 60px var(--neon-cyan);
  }

  /* хакерский текст (вверху экрана) */
  #hackText{
    display:block;
    min-height:48px;
    color:var(--neon);
    font-size:18px;
    text-align:left;
    overflow-wrap:break-word;
  }

  /* стиль активного печатающегося элемента — блестящий карет */
  .typing-cursor::after{
    content: "";
    display:inline-block;
    width:2px;
    height:1.05em;
    background:var(--neon);
    margin-left:6px;
    animation:blink 0.8s steps(1) infinite;
    vertical-align:bottom;
  }
  @keyframes blink{
    0%,50%,100%{opacity:1}
    25%,75%{opacity:0}
  }

  /* карточка поздравления */
  .card{
    margin-top:18px;
    padding:18px;
    background:rgba(0,0,0,0.55);
    border-radius:12px;
    border:2px solid var(--neon);
    box-shadow:0 0 14px var(--neon),0 0 30px var(--neon-2);
    display:none;           /* покажем после "взлома" */
    text-align:left;
  }
  .card p{
    margin:8px 0;
    color:var(--neon);
    text-shadow:0 0 6px var(--neon),0 0 12px var(--neon-2);
    font-size:16px;
    line-height:1.25;
  }

  /* адаптация для мобильных — правый код сворачиваем */
  @media (max-width:900px){
    .code-background{ display:none; }
    .screen{ width:92%; }
  }
</style>
</head>
<body>

  <!-- правая колонка с кодом -->
  <div class="code-background" id="codeBg" aria-hidden="true"></div>

  <!-- центральный экран: хак-текст и карточка -->
  <div class="screen" id="screen">
    <div id="hackText" aria-live="polite"></div>
    <div class="card" id="card" aria-hidden="true"></div>
  </div>

<script>
/* -----------------------
   Настройки / контент
   ----------------------- */

// Твой обновлённый массив hackSteps
const hackSteps = [
  "Ищется код...",
  "Код не найден",
  "Идём на крайние меры",
  "Взлом Пентагона...",
  "Странно, в Пентагоне этого кода нет...",
  "Тогда глянем Компьютер креатора данного кода",
  "О! Вот он!"
];

// Пожелания — останутся на отдельных строках, не стираются
const wishes = [
  "С Днём Рождения, Алёна!",
  "Пусть каждый день будет ярким, как этот неон!",
  "Желаю счастья, радости и вдохновения!",
  "Пусть все мечты сбываются!"
];

/* -----------------------
   Генерация правого фона (строки)
   ----------------------- */

const codeBg = document.getElementById('codeBg');
const chars = '0123456789abcdef<>/{}[]()@#$%^&*-_=+;:,.;:';

// Генерируем N строк и рендерим их как элементы — тогда они не будут растягиваться
function populateCodeBackground(lines = 60, lineLen = 48){
  // очистка
  codeBg.innerHTML = '';
  for(let i=0;i<lines;i++){
    let line = '';
    for(let j=0;j<lineLen;j++){
      line += chars[Math.floor(Math.random()*chars.length)];
    }
    const div = document.createElement('div');
    div.className = 'code-line';
    div.textContent = line;
    codeBg.appendChild(div);
  }
}
// быстрый initial render
populateCodeBackground(120, 36);
// обновление фона регулярно (чтобы оставалось живым)
setInterval(()=> populateCodeBackground(120, 36), 4200);

/* -----------------------
   Функция печати (символ за символом)
   элемент может быть любой DOM-элемент, туда пишем текст
   Возвращает Promise, резолвится после завершения.
   ----------------------- */
function typeTextToElement(el, text, speed = 60){
  return new Promise(resolve=>{
    // включаем визуальный курсор (class)
    el.classList.add('typing-cursor');

    // безопасно: установим textContent пустым перед началом
    el.textContent = '';
    let i = 0;
    const t = setInterval(()=>{
      // guard на случай пустой строки
      if(i >= text.length){
        clearInterval(t);
        // оставим курсор на небольшой момент, затем уберём
        setTimeout(()=>{
          el.classList.remove('typing-cursor');
          resolve();
        }, 350);
        return;
      }
      el.textContent += text[i];
      i++;
    }, speed);
  });
}

/* -----------------------
   Хакерская предыстория -> затем раскрываем карточку
   ----------------------- */
const hackTextElem = document.getElementById('hackText');
const card = document.getElementById('card');

async function runHackSequence(){
  // пробегаем по твоим шагам
  for(let i=0;i<hackSteps.length;i++){
    // очистим элемент и напечатаем следующую строку
    hackTextElem.textContent = '';
    await typeTextToElement(hackTextElem, hackSteps[i], 70);
    // небольшая пауза между шагами (можешь регулировать)
    await new Promise(r=>setTimeout(r, 700));
  }

  // небольшой драматичный эффект перед показом карточки
  await new Promise(r=>setTimeout(r, 500));
  hackTextElem.style.opacity = '0';
  await new Promise(r=>setTimeout(r, 300));

  // покажем карточку и напечатаем пожелания
  card.style.display = 'block';
  card.setAttribute('aria-hidden', 'false');
  await runCard(); // печатаем поздравления
}

/* -----------------------
   Печатаем все пожелания в card, каждое на своей строке и не стираем
   ----------------------- */
async function runCard(){
  for(let i=0;i<wishes.length;i++){
    const p = document.createElement('p');
    card.appendChild(p);
    // для первого элемента (заголовка) можно чуть медленнее печатать
    const speed = (i===0)? 110 : 70;
    await typeTextToElement(p, wishes[i], speed);
    // пауза между строками — даст время прочитать
    await new Promise(r=>setTimeout(r, 400));
  }
}

/* -----------------------
   Запуск
   ----------------------- */
window.addEventListener('load', ()=> {
  // запуск последовательности
  runHackSequence();
});
</script>
</body>
</html>
