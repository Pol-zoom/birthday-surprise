<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>С Днём Рождения, Алёна!</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: black;
    font-family: monospace;
  }
  #matrix, #particles {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
  #message {
    position: fixed;
    right: 20px;
    top: 20px;
    color: #ffb6ff;
    font-size: 24px;
    white-space: pre-wrap;
    font-family: monospace;
    z-index: 999;
  }
</style>
</head>
<body>
<canvas id="matrix"></canvas>
<canvas id="particles"></canvas>
<div id="message"></div>

<script>
// ======== Настройка матрицы ========
const canvas = document.getElementById('matrix');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const fontSize = 18;
let columns = Math.floor(canvas.width / fontSize);
let drops = Array(columns).fill(1);
let matrixChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%^&*()*&^%";
matrixChars = matrixChars.split('');

function drawMatrix() {
  ctx.fillStyle = 'rgba(0,0,0,0.05)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = '#8a2be2'; // фиолетовый
  ctx.font = fontSize + "px monospace";
  for(let i = 0; i < drops.length; i++){
    const text = matrixChars[Math.floor(Math.random()*matrixChars.length)];
    ctx.fillText(text, i*fontSize, drops[i]*fontSize);
    drops[i]++;
    if(drops[i]*fontSize > canvas.height && Math.random() > 0.975) drops[i]=0;
  }
}

// ======== Частицы для взрыва ========
const pCanvas = document.getElementById('particles');
const pctx = pCanvas.getContext('2d');
pCanvas.width = window.innerWidth;
pCanvas.height = window.innerHeight;

function spawnExplosion(x,y,color,count){
  for(let i=0;i<count;i++){
    const particle = {
      x: x,
      y: y,
      dx: (Math.random()-0.5)*6,
      dy: (Math.random()-0.5)*6,
      alpha: 1,
      color: color,
      size: 3+Math.random()*3
    };
    particles.push(particle);
  }
}

let particles = [];
function updateParticles(){
  pctx.clearRect(0,0,pCanvas.width,pCanvas.height);
  for(let i=0;i<particles.length;i++){
    const p = particles[i];
    p.x += p.dx;
    p.y += p.dy;
    p.alpha -= 0.02;
    pctx.fillStyle = p.color;
    pctx.globalAlpha = p.alpha;
    pctx.beginPath();
    pctx.arc(p.x,p.y,p.size,0,Math.PI*2);
    pctx.fill();
  }
  pctx.globalAlpha = 1;
  particles = particles.filter(p=>p.alpha>0);
}

// ======== Поздравление ========
const message = document.getElementById('message');
const hackSteps = [
  "Ищется код...",
  "Код не найден",
  "Идём на крайние меры",
  "Взлом Пентагона...",
  "Странно, в Пентагоне этого кода нет...",
  "Тогда глянем Компьютер креатора данного кода",
  "О! Вот он!"
];
const wishes = [
  "С Днём Рождения, Алёна!",
  "Пусть каждый день будет ярким, как этот неон!",
  "Пусть сбудется всё, что задумано!"
];

let stepIndex = 0;
let wishIndex = 0;
let hackDone = false;

function showHackStep(){
  if(stepIndex<hackSteps.length){
    message.textContent = hackSteps[stepIndex];
    stepIndex++;
    setTimeout(showHackStep,800);
  }else{
    hackDone = true;
    showWish();
  }
}

function showWish(){
  if(wishIndex<wishes.length){
    message.textContent = wishes[wishIndex];
    wishIndex++;
    setTimeout(showWish,1200);
  }else{
    message.textContent = "";
  }
}

// ======== Секретная дата в падающем коде (редко) ========
(function(){
  const secretText = "1 ноября";
  const secretChars = secretText.split('');

  const originalDrawMatrix = drawMatrix;
  drawMatrix = function(){
    originalDrawMatrix();

    // Редко вставляем один случайный символ из даты
    if(Math.random() < 0.005){ // 0.5% шанс на каждом кадре
      const col = Math.floor(Math.random() * drops.length);
      const char = secretChars[Math.floor(Math.random() * secretChars.length)];
      ctx.save();
      ctx.fillStyle = '#ff69b4'; // чуть ярче, но сливается с фиолетовым
      ctx.font = fontSize + "px monospace";
      ctx.fillText(char, col*fontSize, drops[col]*fontSize);
      ctx.restore();
    }
  };
})();

// ======== Enter или тап для активации ========
function activate(){
  if(!hackDone) showHackStep();
  else {} // Пасхалка скрыта, просто наблюдение
}
window.addEventListener('keydown', e=>{if(e.key==='Enter') activate();});
window.addEventListener('click', activate);
window.addEventListener('touchstart', activate, {passive:true});

// ======== Основной цикл ========
function loop(){
  drawMatrix();
  updateParticles();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
